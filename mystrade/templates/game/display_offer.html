{% load filters %}

<div>
    {% if offer.rules.all %}
        <h4>Rules</h4>
        <div class="css_table">
            {% for card in offer.rules.all %}
                {% if forloop.first or forloop.counter0|divisibleby:"4" %}
                    <div class="css_table-row">
                {% endif %}
            <div class="css_table-cell">
                <div class="card">
                    <div class="card_name">{{ card.rulecard.public_name }}</div>
                    <div class="card_desc">
                        {% if trade.status == 'ACCEPTED' or giver == user %}
                            {{ card.rulecard.description }}
                        {% else %}
                            <span class="helptext">(Hidden until trade accepted)</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% if forloop.counter|divisibleby:"4" or forloop.last %}
                </div>
            {% endif %}
            {% endfor %}
        </div>
    {% endif %}
    {% if offer.tradedcommodities_set.all %}
        <h4>Commodities</h4>
        <div class="css_table">
            <div class="css_table-row">
                {% for card in offer.tradedcommodities_set.all %}
                    <div class="css_table-cell card">
                        <div class="card_name">{{ card.commodity.commodity.name }}</div>
                        <div class="card_copies">
                            {% for copy in card.nb_traded_cards|as_range %}
                                <span class="minicard" style="background-color: {{ card.commodity.commodity.color }}">&nbsp;</span>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    {% if offer.free_information %}
        <div>
            <h4>Free information(s)</h4>
            {% if trade.status == 'ACCEPTED' or giver == user %}
                {{ offer.free_information }}<br/>
            {% else %}
                <span class="helptext">Some information(s), hidden until this trade is accepted by both players.</span>
            {% endif %}
        </div>
    {% endif %}
    {% if offer.comment %}
        <div>
            <h4>Comment:</h4>
            {{ offer.comment }}
        </div>
    {% endif %}
</div>